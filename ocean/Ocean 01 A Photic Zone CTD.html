
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Photic Zone: CTD and other low data rate sensors &#8212; Interactive Oceans Resources</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.c441f2ba0852f4cabcb80105e3a46ae6.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Visualization" href="../visualization/index.html" />
    <link rel="prev" title="Ocean Data Science" href="index.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/ooi-rsn-logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Interactive Oceans Resources</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to Interactive Oceans Resources Site
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="index.html">
   Ocean Data Science
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Photic Zone: CTD and other low data rate sensors
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../visualization/index.html">
   Visualization
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../visualization/Datashading.html">
     How Interactive Oceans Displays Large Datasets
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/ocean/Ocean 01 A Photic Zone CTD.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/cormorack/resources"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/cormorack/resources/issues/new?title=Issue%20on%20page%20%2Focean/Ocean 01 A Photic Zone CTD.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/cormorack/resources/edit/main/book/ocean/Ocean 01 A Photic Zone CTD.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/cormorack/resources/main?urlpath=tree/book/ocean/Ocean 01 A Photic Zone CTD.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#study-site-locations">
   Study site locations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ctd-including-dissolved-oxygen">
   CTD including Dissolved Oxygen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pco2">
   pCO2
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nitrate">
   Nitrate
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ph">
   pH
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fluorometer">
   Fluorometer
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spectral-irradiance">
   Spectral Irradiance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#photosynthetically-available-radiation">
   Photosynthetically Available Radiation
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <blockquote>
<div><p><em><strong>If we shadows have offended,</strong></em><BR>
<em><strong>Think but this, and all is mended,</strong></em><BR>
<em><strong>That you have but slumber’d here</strong></em><BR>
<em><strong>While these visions did appear.</strong></em><BR></p>
</div></blockquote>
<div class="section" id="photic-zone-ctd-and-other-low-data-rate-sensors">
<h1>Photic Zone: CTD and other low data rate sensors<a class="headerlink" href="#photic-zone-ctd-and-other-low-data-rate-sensors" title="Permalink to this headline">¶</a></h1>
<p>The ‘photic zone’ is the upper layer of the ocean regularly illuminated by sunlight. This set of photic zone
notebooks concerns sensor data from the surface to about 200 meters depth. Data are acquired from two to nine
times per day by shallow profilers. This notebook covers CTD (salinity
and temperature), dissolved oxygen, nitrate, pH, spectral irradiance, fluorometry and photosynthetically
available radiation (PAR).</p>
<p>Data are first taken from the Regional Cabled Array shallow profilers and platforms. A word of explanation here: The
profilers rise and then fall over the course of about 80 minutes, nine times per day, from a depth of 200 meters
to within about 10 meters of the surface. As the ascend and descend they record data. The resting location in
between these excursions is a platform 200 meters below the surface that is anchored to the see floor. The platform
also carries sensors that measure basic ocean water properties.</p>
<BR>
<img src="../_static/images/vessels/revelle.jpg" style="float: left;" alt="ship and iceberg photo" width="900"/>
<div style="clear: left"><BR>
<p>Research ship Revelle in the southern ocean: 100 meters in length.
Note: Ninety percent of this iceberg is beneath the surface.</p>
<p>More on the Regional Cabled Array oceanography program <a class="reference external" href="https://interactiveoceans.washington.edu">here</a>.</p>
<div class="section" id="study-site-locations">
<h2>Study site locations<a class="headerlink" href="#study-site-locations" title="Permalink to this headline">¶</a></h2>
<p>We begin with three sites in the northeast Pacific:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Site</span> <span class="n">name</span>               <span class="n">Lat</span>               <span class="n">Lon</span>
<span class="o">------------------</span>      <span class="o">---</span>               <span class="o">---</span>
<span class="n">Oregon</span> <span class="n">Offshore</span>         <span class="mf">44.37415</span>          <span class="o">-</span><span class="mf">124.95648</span>
<span class="n">Oregon</span> <span class="n">Slope</span> <span class="n">Base</span>       <span class="mf">44.52897</span>          <span class="o">-</span><span class="mf">125.38966</span> 
<span class="n">Axial</span> <span class="n">Base</span>              <span class="mf">45.83049</span>          <span class="o">-</span><span class="mf">129.75326</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">glob</span><span class="o">,</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">clear_output</span>             <span class="c1"># use inside loop with clear_output(wait = True) followed by print(i)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../_static/data&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span> <span class="k">as</span> <span class="n">mplcolors</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="o">,</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">datetime64</span> <span class="k">as</span> <span class="n">dt64</span><span class="p">,</span> <span class="n">timedelta64</span> <span class="k">as</span> <span class="n">td64</span>

<span class="c1"># convenience functions abbreviating &#39;datetime64&#39; and so on</span>
<span class="k">def</span> <span class="nf">doy</span><span class="p">(</span><span class="n">theDatetime</span><span class="p">):</span> <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">((</span><span class="n">theDatetime</span> <span class="o">-</span> <span class="n">dt64</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">theDatetime</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;-01-01&#39;</span><span class="p">))</span> <span class="o">/</span> <span class="n">td64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">dt64_from_doy</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">doy</span><span class="p">):</span> <span class="k">return</span> <span class="n">dt64</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-01-01&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">td64</span><span class="p">(</span><span class="n">doy</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">day_of_month_to_string</span><span class="p">(</span><span class="n">d</span><span class="p">):</span> <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="mi">9</span> <span class="k">else</span> <span class="s1">&#39;0&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Jupyter Notebook running Python </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jupyter Notebook running Python 3
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ctd-including-dissolved-oxygen">
<h2>CTD including Dissolved Oxygen<a class="headerlink" href="#ctd-including-dissolved-oxygen" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">osb_ctd_nc_file</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;rca/ctd/osb_ctd_jan2019_1min.nc&quot;</span>
<span class="n">ds_CTD</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">osb_ctd_nc_file</span><span class="p">)</span>
<span class="n">ds_CTD</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">/usr/share/miniconda3/envs/cava-resources/lib/python3.8/site-packages/xarray/backends/file_manager.py</span> in <span class="ni">_acquire_with_cache_info</span><span class="nt">(self, needs_lock)</span>
<span class="g g-Whitespace">    </span><span class="mi">198</span>             <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">199</span>                 <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_key</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">200</span>             <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>

<span class="nn">/usr/share/miniconda3/envs/cava-resources/lib/python3.8/site-packages/xarray/backends/lru_cache.py</span> in <span class="ni">__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">     </span><span class="mi">52</span>         <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">53</span>             <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">54</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">move_to_end</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="ne">KeyError</span>: [&lt;function _open_scipy_netcdf at 0x7f98530063a0&gt;, (&#39;/home/runner/work/resources/resources/book/_static/data/rca/ctd/osb_ctd_jan2019_1min.nc&#39;,), &#39;r&#39;, ((&#39;mmap&#39;, None), (&#39;version&#39;, 2))]

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">/usr/share/miniconda3/envs/cava-resources/lib/python3.8/site-packages/xarray/backends/scipy_.py</span> in <span class="ni">_open_scipy_netcdf</span><span class="nt">(filename, mode, mmap, version)</span>
<span class="g g-Whitespace">     </span><span class="mi">93</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">94</span>         <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">netcdf_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">mmap</span><span class="o">=</span><span class="n">mmap</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">95</span>     <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># netcdf3 message is obscure in this case</span>

<span class="nn">/usr/share/miniconda3/envs/cava-resources/lib/python3.8/site-packages/scipy/io/netcdf.py</span> in <span class="ni">__init__</span><span class="nt">(self, filename, mode, mmap, version, maskandscale)</span>
<span class="g g-Whitespace">    </span><span class="mi">280</span>         <span class="k">if</span> <span class="n">mode</span> <span class="ow">in</span> <span class="s1">&#39;ra&#39;</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">281</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_read</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">282</span> 

<span class="nn">/usr/share/miniconda3/envs/cava-resources/lib/python3.8/site-packages/scipy/io/netcdf.py</span> in <span class="ni">_read</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">601</span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">magic</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;CDF&#39;</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">602</span>             <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Error: </span><span class="si">%s</span><span class="s2"> is not a valid NetCDF 3 file&quot;</span> <span class="o">%</span>
<span class="g g-Whitespace">    </span><span class="mi">603</span>                             <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>

<span class="ne">TypeError</span>: Error: /home/runner/work/resources/resources/book/_static/data/rca/ctd/osb_ctd_jan2019_1min.nc is not a valid NetCDF 3 file

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">779868</span><span class="n">ffab58</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">osb_ctd_nc_file</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;rca/ctd/osb_ctd_jan2019_1min.nc&quot;</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">ds_CTD</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">osb_ctd_nc_file</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">ds_CTD</span>

<span class="nn">/usr/share/miniconda3/envs/cava-resources/lib/python3.8/site-packages/xarray/backends/api.py</span> in <span class="ni">open_dataset</span><span class="nt">(filename_or_obj, group, decode_cf, mask_and_scale, decode_times, concat_characters, decode_coords, engine, chunks, lock, cache, drop_variables, backend_kwargs, use_cftime, decode_timedelta)</span>
<span class="g g-Whitespace">    </span><span class="mi">555</span> 
<span class="g g-Whitespace">    </span><span class="mi">556</span>     <span class="k">with</span> <span class="n">close_on_error</span><span class="p">(</span><span class="n">store</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">557</span>         <span class="n">ds</span> <span class="o">=</span> <span class="n">maybe_decode_store</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">chunks</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">558</span> 
<span class="nn">    559     # Ensure source filename always stored</span> in <span class="ni">dataset object </span><span class="nt">(GH issue #2550)</span>

<span class="nn">/usr/share/miniconda3/envs/cava-resources/lib/python3.8/site-packages/xarray/backends/api.py</span> in <span class="ni">maybe_decode_store</span><span class="nt">(store, chunks)</span>
<span class="g g-Whitespace">    </span><span class="mi">451</span> 
<span class="g g-Whitespace">    </span><span class="mi">452</span>     <span class="k">def</span> <span class="nf">maybe_decode_store</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">chunks</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">453</span>         <span class="n">ds</span> <span class="o">=</span> <span class="n">conventions</span><span class="o">.</span><span class="n">decode_cf</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">454</span>             <span class="n">store</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">455</span>             <span class="n">mask_and_scale</span><span class="o">=</span><span class="n">mask_and_scale</span><span class="p">,</span>

<span class="nn">/usr/share/miniconda3/envs/cava-resources/lib/python3.8/site-packages/xarray/conventions.py</span> in <span class="ni">decode_cf</span><span class="nt">(obj, concat_characters, mask_and_scale, decode_times, decode_coords, drop_variables, use_cftime, decode_timedelta)</span>
<span class="g g-Whitespace">    </span><span class="mi">637</span>         <span class="n">encoding</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">encoding</span>
<span class="g g-Whitespace">    </span><span class="mi">638</span>     <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">AbstractDataStore</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">639</span>         <span class="nb">vars</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">640</span>         <span class="n">extra_coords</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">641</span>         <span class="n">close</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">close</span>

<span class="nn">/usr/share/miniconda3/envs/cava-resources/lib/python3.8/site-packages/xarray/backends/common.py</span> in <span class="ni">load</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span>         <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span><span class="sd">         variables = FrozenDict(</span>
<span class="nn">--&gt; 113             (_decode_variable_name(k), v) for k, v</span> in <span class="ni">self.get_variables().items</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span><span class="sd">         )</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span><span class="sd">         attributes = FrozenDict(self.get_attrs())</span>

<span class="nn">/usr/share/miniconda3/envs/cava-resources/lib/python3.8/site-packages/xarray/backends/scipy_.py</span> in <span class="ni">get_variables</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">164</span><span class="sd">     def get_variables(self):</span>
<span class="g g-Whitespace">    </span><span class="mi">165</span><span class="sd">         return FrozenDict(</span>
<span class="nn">--&gt; 166             (k, self.open_store_variable(k, v)) for k, v</span> in <span class="ni">self.ds.variables.items</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">167</span><span class="sd">         )</span>
<span class="g g-Whitespace">    </span><span class="mi">168</span><span class="sd"> </span>

<span class="nn">/usr/share/miniconda3/envs/cava-resources/lib/python3.8/site-packages/xarray/backends/scipy_.py</span> in <span class="ni">ds</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span><span class="sd">     @property</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span><span class="sd">     def ds(self):</span>
<span class="ne">--&gt; </span><span class="mi">155</span><span class="sd">         return self._manager.acquire()</span>
<span class="g g-Whitespace">    </span><span class="mi">156</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">157</span><span class="sd">     def open_store_variable(self, name, var):</span>

<span class="nn">/usr/share/miniconda3/envs/cava-resources/lib/python3.8/site-packages/xarray/backends/file_manager.py</span> in <span class="ni">acquire</span><span class="nt">(self, needs_lock)</span>
<span class="g g-Whitespace">    </span><span class="mi">179</span><span class="sd">             An open file object, as returned by ``opener(*args, **kwargs)``.</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span><span class="sd">         &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">181</span>         <span class="n">file</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_acquire_with_cache_info</span><span class="p">(</span><span class="n">needs_lock</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">182</span>         <span class="k">return</span> <span class="n">file</span>
<span class="g g-Whitespace">    </span><span class="mi">183</span> 

<span class="nn">/usr/share/miniconda3/envs/cava-resources/lib/python3.8/site-packages/xarray/backends/file_manager.py</span> in <span class="ni">_acquire_with_cache_info</span><span class="nt">(self, needs_lock)</span>
<span class="g g-Whitespace">    </span><span class="mi">203</span>                     <span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">204</span>                     <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span>
<span class="ne">--&gt; </span><span class="mi">205</span>                 <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opener</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span>                 <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">==</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span>                     <span class="c1"># ensure file doesn&#39;t get overriden when opened again</span>

<span class="nn">/usr/share/miniconda3/envs/cava-resources/lib/python3.8/site-packages/xarray/backends/scipy_.py</span> in <span class="ni">_open_scipy_netcdf</span><span class="nt">(filename, mode, mmap, version)</span>
<span class="g g-Whitespace">    </span><span class="mi">103</span>             <span class="s2">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">104</span><span class="s2">             errmsg += msg</span>
<span class="ne">--&gt; </span><span class="mi">105</span><span class="s2">             raise TypeError(errmsg)</span>
<span class="g g-Whitespace">    </span><span class="mi">106</span><span class="s2">         else:</span>
<span class="g g-Whitespace">    </span><span class="mi">107</span><span class="s2">             raise</span>

<span class="ne">TypeError</span>: Error: /home/runner/work/resources/resources/book/_static/data/rca/ctd/osb_ctd_jan2019_1min.nc is not a valid NetCDF 3 file
<span class="s2">            If this is a NetCDF4 file, you may need to install the</span>
<span class="s2">            netcdf4 library, e.g.,</span>

<span class="s2">            $ pip install netcdf4</span>
<span class="s2">            </span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time0</span> <span class="o">=</span> <span class="n">dt64</span><span class="p">(</span><span class="s1">&#39;2019-01-01&#39;</span><span class="p">)</span>
<span class="n">time1</span> <span class="o">=</span> <span class="n">dt64</span><span class="p">(</span><span class="s1">&#39;2019-01-02&#39;</span><span class="p">)</span>
<span class="n">ds_CTD_time_slice</span> <span class="o">=</span> <span class="n">ds_CTD</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">time0</span><span class="p">,</span> <span class="n">time1</span><span class="p">))</span>    <span class="c1"># one day</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds_CTD_time_slice</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">ds_CTD_time_slice</span><span class="o">.</span><span class="n">seawater_pressure</span><span class="p">,</span> \
            <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mf">9.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">200.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;nine profiles: pressure over 24 hours (profiles)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>...
</pre></div>
</div>
<img alt="../_images/Ocean 01 A Photic Zone CTD_4_1.png" src="../_images/Ocean 01 A Photic Zone CTD_4_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is one approach to time bounding: Grab n days out of a longer dataset (n = 3 for example)</span>
<span class="c1"># contrasting idea: See the nitrate section where profiles are staggered</span>
<span class="n">day_of_month_start</span> <span class="o">=</span> <span class="s1">&#39;25&#39;</span>
<span class="n">day_of_month_end</span> <span class="o">=</span> <span class="s1">&#39;27&#39;</span>
<span class="n">time0</span> <span class="o">=</span> <span class="n">dt64</span><span class="p">(</span><span class="s1">&#39;2019-01-&#39;</span> <span class="o">+</span> <span class="n">day_of_month_start</span><span class="p">)</span>
<span class="n">time1</span> <span class="o">=</span> <span class="n">dt64</span><span class="p">(</span><span class="s1">&#39;2019-01-&#39;</span> <span class="o">+</span> <span class="n">day_of_month_end</span><span class="p">)</span>

<span class="n">temperature_upper_bound</span> <span class="o">=</span> <span class="mf">12.</span>
<span class="n">temperature_lower_bound</span> <span class="o">=</span> <span class="mf">7.</span>
<span class="n">salinity_upper_bound</span> <span class="o">=</span> <span class="mf">35.</span>
<span class="n">salinity_lower_bound</span> <span class="o">=</span> <span class="mf">32.</span>
<span class="n">dissolved_oxygen_upper_bound</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">dissolved_oxygen_lower_bound</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">ds_CTD_time_slice</span> <span class="o">=</span> <span class="n">ds_CTD</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">time0</span><span class="p">,</span> <span class="n">time1</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ds_CTD_time_slice</span><span class="o">.</span><span class="n">seawater_temperature</span><span class="p">,</span> <span class="n">ds_CTD_time_slice</span><span class="o">.</span><span class="n">seawater_pressure</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">temperature_lower_bound</span><span class="p">,</span> <span class="n">temperature_upper_bound</span><span class="p">),</span> \
        <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">200.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;several profiles: seawater temperature&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ds_CTD_time_slice</span><span class="o">.</span><span class="n">practical_salinity</span><span class="p">,</span> \
            <span class="n">ds_CTD_time_slice</span><span class="o">.</span><span class="n">seawater_pressure</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">salinity_lower_bound</span><span class="p">,</span> <span class="n">salinity_upper_bound</span><span class="p">),</span> \
        <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">200.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;several profiles: salinity&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ds_CTD_time_slice</span><span class="o">.</span><span class="n">corrected_dissolved_oxygen</span><span class="p">,</span> \
            <span class="n">ds_CTD_time_slice</span><span class="o">.</span><span class="n">seawater_pressure</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">dissolved_oxygen_lower_bound</span><span class="p">,</span> <span class="n">dissolved_oxygen_upper_bound</span><span class="p">),</span> \
        <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">200.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;several profiles: dissolved oxygen&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>...
</pre></div>
</div>
<img alt="../_images/Ocean 01 A Photic Zone CTD_5_1.png" src="../_images/Ocean 01 A Photic Zone CTD_5_1.png" />
</div>
</div>
</div>
<div class="section" id="pco2">
<h2>pCO2<a class="headerlink" href="#pco2" title="Permalink to this headline">¶</a></h2>
<p>This seems to be only 2600 observations from June 23 to September 27, 2019.
These data are otherwise dubious as well.
No charting attempted.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pCO2_source = &#39;/data/rca/pCO2/&#39;</span>
<span class="c1"># pCO2_data = &#39;depl*PCO2*.nc&#39;</span>
<span class="c1"># ds_pCO2 = xr.open_mfdataset(pCO2_source + pCO2_data)   # example of multi-file</span>
<span class="c1"># ds_pCO2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># print(&#39;pCO2 time range: &#39; + str(ds_pCO2.time[0].values) + &#39; to &#39; + str(ds_pCO2.time[-1].values))</span>
<span class="c1">#</span>
<span class="c1"># produces:</span>
<span class="c1">#</span>
<span class="c1"># pCO2 time range: 2019-06-23T06:35:03.680657408 to 2019-09-27T17:35:22.647006208</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="nitrate">
<h2>Nitrate<a class="headerlink" href="#nitrate" title="Permalink to this headline">¶</a></h2>
<p>This dataset for January 2019 includes 30 days of 31; but also falls over on Jan 16 and 17.
There is some corresponding hard-coding. There are two profiles per day – on at midnight,
one at noon – and these are charted all at once using a shift-per-day approach.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nitrate_source</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;rca/nitrate&#39;</span>
<span class="n">nitrate_data_midnight</span> <span class="o">=</span> <span class="s1">&#39;nc_midn_2019_01.nc&#39;</span>
<span class="n">nitrate_data_noon</span>     <span class="o">=</span> <span class="s1">&#39;nc_noon_2019_01.nc&#39;</span>

<span class="n">ds_nitrate_midn</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">nitrate_source</span> <span class="o">/</span> <span class="n">nitrate_data_midnight</span><span class="p">)</span>
<span class="n">ds_nitrate_noon</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">nitrate_source</span> <span class="o">/</span> <span class="n">nitrate_data_noon</span><span class="p">)</span>

<span class="n">ds_nitrate_midn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                (doy: 30, int_ctd_pressure_bins: 800)
Coordinates:
  * int_ctd_pressure_bins  (int_ctd_pressure_bins) float64 0.125 0.375 ... 199.9
  * doy                    (doy) int64 1 2 3 4 5 6 7 8 ... 25 26 27 28 29 30 31
Data variables:
    nitrate_concentration  (int_ctd_pressure_bins, doy) float32 nan nan ... nan</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-9a33320d-3016-4afe-ac1a-ed130ecc220d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9a33320d-3016-4afe-ac1a-ed130ecc220d' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>doy</span>: 30</li><li><span class='xr-has-index'>int_ctd_pressure_bins</span>: 800</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f769c57d-80f3-4726-a110-2571022b5644' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f769c57d-80f3-4726-a110-2571022b5644' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>int_ctd_pressure_bins</span></div><div class='xr-var-dims'>(int_ctd_pressure_bins)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.125 0.375 0.625 ... 199.6 199.9</div><input id='attrs-0b3ac081-9618-4ae9-a381-79b7a14cd539' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0b3ac081-9618-4ae9-a381-79b7a14cd539' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b58a67ac-e0a3-4f0e-8137-44a7748fcb5e' class='xr-var-data-in' type='checkbox'><label for='data-b58a67ac-e0a3-4f0e-8137-44a7748fcb5e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1.25000e-01, 3.75000e-01, 6.25000e-01, ..., 1.99375e+02, 1.99625e+02,
       1.99875e+02])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>doy</span></div><div class='xr-var-dims'>(doy)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 ... 26 27 28 29 30 31</div><input id='attrs-4010e4e9-7656-4e19-8f69-5fb6a1af0f73' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4010e4e9-7656-4e19-8f69-5fb6a1af0f73' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a2ad999a-9e9f-414e-a93d-2c7da3428a4c' class='xr-var-data-in' type='checkbox'><label for='data-a2ad999a-9e9f-414e-a93d-2c7da3428a4c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 18, 19,
       20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7e99e72f-2fc6-4936-b302-9cdfbd96735a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7e99e72f-2fc6-4936-b302-9cdfbd96735a' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>nitrate_concentration</span></div><div class='xr-var-dims'>(int_ctd_pressure_bins, doy)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-2a4551f8-72bf-4449-a9d5-888cd2e8153a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2a4551f8-72bf-4449-a9d5-888cd2e8153a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5733bce5-dc95-4017-9ce7-958e336871a7' class='xr-var-data-in' type='checkbox'><label for='data-5733bce5-dc95-4017-9ce7-958e336871a7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5063d234-300f-48d2-a957-0700c9bb9bdf' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5063d234-300f-48d2-a957-0700c9bb9bdf' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to do: auto-detect the data fails on doy 16, 17, 31 rather than hardcode exceptions</span>
<span class="c1">#     try: f = ds_nitrate_noon.nitrate_concentration.sel(doy=16)</span>
<span class="c1">#     except: print(&#39;16 bad&#39;)</span>
<span class="c1"># to do: print day of month adjacent to profile; verify noon - midn colors match for corresp doy </span>

<span class="n">nProfiles</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">profile_shift</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">colorwheel</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]</span>
<span class="n">cwmod</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colorwheel</span><span class="p">)</span>
<span class="n">nitrate_upper_bound</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">+</span> <span class="p">(</span><span class="n">nProfiles</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">profile_shift</span>
<span class="n">nitrate_lower_bound</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">da_i</span> <span class="ow">in</span> <span class="n">ds_nitrate_midn</span><span class="o">.</span><span class="n">doy</span><span class="p">:</span>                <span class="c1"># da_ means it is a data array</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">da_i</span><span class="p">)</span>                               <span class="c1"># taking int(da) gives day of month as integer</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">16</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">17</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">31</span><span class="p">):</span>     <span class="c1"># these three days fail to chart (harcoded; see to do)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ds_nitrate_noon</span><span class="o">.</span><span class="n">nitrate_concentration</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">doy</span><span class="o">=</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="n">profile_shift</span><span class="p">,</span> \
            <span class="n">ds_nitrate_noon</span><span class="o">.</span><span class="n">int_ctd_pressure_bins</span><span class="p">,</span>  <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colorwheel</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="k">cwmod</span>]) 
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">nitrate_lower_bound</span><span class="p">,</span> <span class="n">nitrate_upper_bound</span><span class="p">),</span> \
            <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">200.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;nitrate concentration: noon profile&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ds_nitrate_midn</span><span class="o">.</span><span class="n">nitrate_concentration</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">doy</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">profile_shift</span><span class="p">,</span> \
        <span class="n">ds_nitrate_midn</span><span class="o">.</span><span class="n">int_ctd_pressure_bins</span><span class="p">,</span>  <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colorwheel</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="k">cwmod</span>]) 
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">nitrate_lower_bound</span><span class="p">,</span> <span class="n">nitrate_upper_bound</span><span class="p">),</span> \
        <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">200.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;nitrate concentration: midnight profile&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>...
</pre></div>
</div>
<img alt="../_images/Ocean 01 A Photic Zone CTD_11_1.png" src="../_images/Ocean 01 A Photic Zone CTD_11_1.png" />
</div>
</div>
</div>
<div class="section" id="ph">
<h2>pH<a class="headerlink" href="#ph" title="Permalink to this headline">¶</a></h2>
<p>As with nitrate above: pH is measured during two profiles each day (of nine possible).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pH_source</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;rca/pH&#39;</span>
<span class="n">pH_data</span> <span class="o">=</span> <span class="s1">&#39;osb_sp_phsen_2019.nc&#39;</span>
<span class="n">ds_pH</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">pH_source</span> <span class="o">/</span> <span class="n">pH_data</span><span class="p">)</span>
<span class="n">ds_pH</span>

<span class="c1"># This generates a pressure/time curtain plot; good in that it shows data dropouts</span>
<span class="c1">#   ...but better is to color it by pH, see to do</span>
<span class="c1"># ds_pH.int_ctd_pressure.plot()       </span>
<span class="c1"># sanity check: Is this profile data as we expect?</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:           (time: 7711)
Coordinates:
  * time              (time) datetime64[ns] 2019-01-01T02:13:06.062041088 ......
    int_ctd_pressure  (time) float64 191.9 192.0 191.8 ... 191.4 192.9 195.0
Data variables:
    ph_seawater       (time) float64 7.792 7.785 7.778 ... 7.722 7.755 7.728
Attributes:
    node:                SF01A
    id:                  RS01SBPS-SF01A-2D-PHSENA101-streamed-phsen_data_record
    geospatial_lat_min:  44.52897
    geospatial_lon_min:  -125.38966</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-9a0024ae-5172-401e-bcd3-fbe1ed6dd1ec' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9a0024ae-5172-401e-bcd3-fbe1ed6dd1ec' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7711</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f947e3f4-bd1c-45ef-961a-01ed880bfba5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f947e3f4-bd1c-45ef-961a-01ed880bfba5' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2019-01-01T02:13:06.062041088 .....</div><input id='attrs-f279052f-d81a-4b03-b18b-4ce161cbe8a9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f279052f-d81a-4b03-b18b-4ce161cbe8a9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b52eed8f-e3a8-43d3-8601-e954d6289928' class='xr-var-data-in' type='checkbox'><label for='data-b52eed8f-e3a8-43d3-8601-e954d6289928' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2019-01-01T02:13:06.062041088&#x27;, &#x27;2019-01-01T04:28:06.146778112&#x27;,
       &#x27;2019-01-01T06:37:35.609661440&#x27;, ..., &#x27;2019-09-27T12:53:30.878338048&#x27;,
       &#x27;2019-09-27T15:14:44.976699392&#x27;, &#x27;2019-09-27T17:31:13.218280960&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>int_ctd_pressure</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-9dc05055-07b8-4dbc-ad6b-b4be29493313' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9dc05055-07b8-4dbc-ad6b-b4be29493313' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8cbfabc7-c5ee-412e-a6db-ec16255a34c3' class='xr-var-data-in' type='checkbox'><label for='data-8cbfabc7-c5ee-412e-a6db-ec16255a34c3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>comment :</span></dt><dd>Seawater Pressure refers to the pressure exerted on a sensor in situ by the weight of the column of seawater above it. It is calculated by subtracting one standard atmosphere from the absolute pressure at the sensor to remove the weight of the atmosphere on top of the water column. The pressure at a sensor in situ provides a metric of the depth of that sensor.</dd><dt><span>data_product_identifier :</span></dt><dd>PRESWAT_L1</dd><dt><span>precision :</span></dt><dd>3</dd><dt><span>long_name :</span></dt><dd>Seawater Pressure</dd><dt><span>standard_name :</span></dt><dd>sea_water_pressure</dd><dt><span>units :</span></dt><dd>dbar</dd><dt><span>axis :</span></dt><dd>Z</dd></dl></div><div class='xr-var-data'><pre>array([191.887911, 191.966526, 191.848281, ..., 191.425874, 192.948098,
       194.994155])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4521cbeb-65e1-4d78-8498-5b4209726564' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4521cbeb-65e1-4d78-8498-5b4209726564' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ph_seawater</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-adb7de0e-1135-4eff-9893-6324331b3b26' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-adb7de0e-1135-4eff-9893-6324331b3b26' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e68d1796-263a-4d53-b05b-7d256663c8ea' class='xr-var-data-in' type='checkbox'><label for='data-e68d1796-263a-4d53-b05b-7d256663c8ea' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>comment :</span></dt><dd>pH is a measurement of the concentration of hydrogen ions in a solution. pH ranges from acidic to basic on a scale from 0 to 14 with 7 being neutral.</dd><dt><span>long_name :</span></dt><dd>pH</dd><dt><span>precision :</span></dt><dd>4</dd><dt><span>data_product_identifier :</span></dt><dd>PHWATER_L1</dd><dt><span>standard_name :</span></dt><dd>sea_water_ph_reported_on_total_scale</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>ancillary_variables :</span></dt><dd>phsen_thermistor_temperature,ph_light_measurements,practical_salinity,reference_light_measurements</dd></dl></div><div class='xr-var-data'><pre>array([7.792077, 7.784614, 7.777773, ..., 7.721566, 7.754659, 7.727508])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e6449bff-2244-4382-8659-b30282dac0ca' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e6449bff-2244-4382-8659-b30282dac0ca' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>node :</span></dt><dd>SF01A</dd><dt><span>id :</span></dt><dd>RS01SBPS-SF01A-2D-PHSENA101-streamed-phsen_data_record</dd><dt><span>geospatial_lat_min :</span></dt><dd>44.52897</dd><dt><span>geospatial_lon_min :</span></dt><dd>-125.38966</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pH_temporary_time_start</span> <span class="o">=</span> <span class="s1">&#39;2019-01-21&#39;</span>
<span class="n">pH_temporary_time_end</span>   <span class="o">=</span> <span class="s1">&#39;2019-01-23&#39;</span>


<span class="n">ds_pH_temporary</span> <span class="o">=</span> <span class="n">ds_pH</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">dt64</span><span class="p">(</span><span class="n">pH_temporary_time_start</span><span class="p">),</span> <span class="n">dt64</span><span class="p">(</span><span class="n">pH_temporary_time_end</span><span class="p">)))</span>
<span class="n">ds_CTD_temporary</span> <span class="o">=</span> <span class="n">ds_CTD</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">dt64</span><span class="p">(</span><span class="n">pH_temporary_time_start</span><span class="p">),</span> <span class="n">dt64</span><span class="p">(</span><span class="n">pH_temporary_time_end</span><span class="p">)))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ds_CTD_temporary</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">ds_CTD_temporary</span><span class="o">.</span><span class="n">seawater_pressure</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ds_pH_temporary</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">ds_pH_temporary</span><span class="o">.</span><span class="n">int_ctd_pressure</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mf">64.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">200.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Relationship: Profiler depth to pH sampling strategy&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>...
</pre></div>
</div>
<img alt="../_images/Ocean 01 A Photic Zone CTD_14_1.png" src="../_images/Ocean 01 A Photic Zone CTD_14_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pH_lower_bound</span> <span class="o">=</span> <span class="mf">7.6</span>
<span class="n">pH_upper_bound</span> <span class="o">=</span> <span class="mf">8.2</span>
<span class="n">ds_pH_time_slice</span> <span class="o">=</span> <span class="n">ds_pH</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">time0</span><span class="p">,</span> <span class="n">time1</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ds_pH_time_slice</span><span class="o">.</span><span class="n">ph_seawater</span><span class="p">,</span> \
            <span class="n">ds_pH_time_slice</span><span class="o">.</span><span class="n">int_ctd_pressure</span><span class="p">,</span> \
            <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mf">4.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">pH_lower_bound</span><span class="p">,</span> <span class="n">pH_upper_bound</span><span class="p">),</span> \
        <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">200.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;pH: profiles plus one-shots at end of each profile&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>...
</pre></div>
</div>
<img alt="../_images/Ocean 01 A Photic Zone CTD_15_1.png" src="../_images/Ocean 01 A Photic Zone CTD_15_1.png" />
</div>
</div>
</div>
<div class="section" id="fluorometer">
<h2>Fluorometer<a class="headerlink" href="#fluorometer" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Shallow profiler triplet: chlorophyll, cdom and scattering</p>
<ul>
<li><p>Deep profilers are 2-channel</p></li>
<li><p>they operate continuously</p></li>
</ul>
</li>
<li><p>osb = Oregon Slope Base, SP = shallow profiler</p></li>
<li><p>These data are resampled using mean() to one minute per sample</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fluorometer_source</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;rca/fluorescence&#39;</span>
<span class="n">fluorometer_data</span> <span class="o">=</span> <span class="s1">&#39;osb_sp_fluor_jan2019.nc&#39;</span>
<span class="n">ds_Fluorometer</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">fluorometer_source</span> <span class="o">/</span> <span class="n">fluorometer_data</span><span class="p">)</span>
<span class="n">ds_Fluorometer</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                              (time: 44640)
Coordinates:
  * time                                 (time) datetime64[ns] 2019-01-01 ......
Data variables:
    fluorometric_chlorophyll_a           (time) float64 -0.01772 ... -0.01957
    fluorometric_cdom                    (time) float64 1.86 1.876 ... 1.806
    total_volume_scattering_coefficient  (time) float64 0.0001066 ... 0.0001097
    seawater_scattering_coefficient      (time) float64 0.000639 ... 0.0006384
    optical_backscatter                  (time) float64 0.0007011 ... 0.0007221
    int_ctd_pressure                     (time) float64 191.2 191.2 ... 194.5
Attributes:
    node:                SF01A
    id:                  RS01SBPS-SF01A-3A-FLORTD101-streamed-flort_d_data_re...
    geospatial_lat_min:  44.52897
    geospatial_lon_min:  -125.38966</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-7a6d50e9-e311-4c75-a7fc-777b2d281611' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-7a6d50e9-e311-4c75-a7fc-777b2d281611' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 44640</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-66f98c01-e978-4cc6-ba31-2886a19b1a56' class='xr-section-summary-in' type='checkbox'  checked><label for='section-66f98c01-e978-4cc6-ba31-2886a19b1a56' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2019-01-01 ... 2019-01-31T23:59:00</div><input id='attrs-709805e9-e4b5-4a36-8490-f6fca3debbd2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-709805e9-e4b5-4a36-8490-f6fca3debbd2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1e721a3e-9e57-404f-a914-b657372402ba' class='xr-var-data-in' type='checkbox'><label for='data-1e721a3e-9e57-404f-a914-b657372402ba' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2019-01-01T00:00:00.000000000&#x27;, &#x27;2019-01-01T00:01:00.000000000&#x27;,
       &#x27;2019-01-01T00:02:00.000000000&#x27;, ..., &#x27;2019-01-31T23:57:00.000000000&#x27;,
       &#x27;2019-01-31T23:58:00.000000000&#x27;, &#x27;2019-01-31T23:59:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3cdf59e9-fed7-48b7-afab-c8d0e65ad1fe' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3cdf59e9-fed7-48b7-afab-c8d0e65ad1fe' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>fluorometric_chlorophyll_a</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-765eae6d-2d3f-4747-ad9a-38ff0defd517' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-765eae6d-2d3f-4747-ad9a-38ff0defd517' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-84d1f6ba-4def-4a62-acd6-89a9a21b592a' class='xr-var-data-in' type='checkbox'><label for='data-84d1f6ba-4def-4a62-acd6-89a9a21b592a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>comment :</span></dt><dd>Fluorometric Chlorophyll-a Concentration is an estimate of phytoplankton biomass using fluorescence. The fluorometer emits light at a specific wavelength that is absorbed by chlorophyll and re-emitted as light at a different wavelength. By measuring the intensity of the re-emitted wavelength of light the chlorophyll-a concentration in the surrounding seawater can be estimated. Chlorophyll-a concentrations can be used as a proxy for phytoplankton biomass as it is a dominant photosynthetic pigment.</dd><dt><span>long_name :</span></dt><dd>Chlorophyll-a Concentration</dd><dt><span>precision :</span></dt><dd>6</dd><dt><span>data_product_identifier :</span></dt><dd>CHLAFLO_L1</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_chlorophyll_a_in_sea_water</dd><dt><span>units :</span></dt><dd>µg L-1</dd><dt><span>ancillary_variables :</span></dt><dd>raw_signal_chl</dd></dl></div><div class='xr-var-data'><pre>array([-0.017725, -0.019336, -0.017264, ...,       nan, -0.020453, -0.019566])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>fluorometric_cdom</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-fb9022ed-ff00-48b4-8c6c-322f55d3cb1d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fb9022ed-ff00-48b4-8c6c-322f55d3cb1d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3222e5b4-1854-4dc0-849f-4428e1bc10a8' class='xr-var-data-in' type='checkbox'><label for='data-3222e5b4-1854-4dc0-849f-4428e1bc10a8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>comment :</span></dt><dd>Fluorometric CDOM Concentration is a measure of how much light has been re-emitted (fluoresced) from colored organic compounds found in the colored dissolved organic matter (CDOM) in seawater. Examples of CDOM include tannins (polyphenols that bind to proteins and other large molecules) or lignins (polymers of phenolic acids) from decaying plant material and byproducts from the decomposition of animals. It accounts for the tea-like color in seawater. CDOM is not particulate, but seawater can contain both CDOM and turbidity.</dd><dt><span>long_name :</span></dt><dd>CDOM Concentration</dd><dt><span>precision :</span></dt><dd>6</dd><dt><span>data_product_identifier :</span></dt><dd>CDOMFLO_L1</dd><dt><span>units :</span></dt><dd>ppb</dd><dt><span>ancillary_variables :</span></dt><dd>raw_signal_cdom</dd></dl></div><div class='xr-var-data'><pre>array([1.85996 , 1.876319, 1.864868, ...,      nan, 1.84875 , 1.805977])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>total_volume_scattering_coefficient</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-98a4af3c-56e2-419e-95bc-a5fe42a96193' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-98a4af3c-56e2-419e-95bc-a5fe42a96193' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c17ca136-289f-49f4-ba15-aef09607f4cd' class='xr-var-data-in' type='checkbox'><label for='data-c17ca136-289f-49f4-ba15-aef09607f4cd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>comment :</span></dt><dd>Total Volume Scattering Coefficient values represent the volume scattering from particles and the molecular scattering from water at a given wavelength of light and the default angle of 117 degrees for the ECO meter.</dd><dt><span>long_name :</span></dt><dd>Total Volume Scattering Coefficient</dd><dt><span>precision :</span></dt><dd>6</dd><dt><span>data_product_identifier :</span></dt><dd>FLUBSCT_L1</dd><dt><span>units :</span></dt><dd>m-1 sr-1</dd><dt><span>ancillary_variables :</span></dt><dd>raw_signal_beta</dd></dl></div><div class='xr-var-data'><pre>array([0.000107, 0.000103, 0.000105, ...,      nan, 0.000106, 0.00011 ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>seawater_scattering_coefficient</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-5d45e0d8-5b3e-4aa1-b197-3c042cd3a33e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5d45e0d8-5b3e-4aa1-b197-3c042cd3a33e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3a0fd917-fe8e-40b6-a785-37db6898125b' class='xr-var-data-in' type='checkbox'><label for='data-3a0fd917-fe8e-40b6-a785-37db6898125b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>comment :</span></dt><dd>Total scattering coefficient of pure seawater.</dd><dt><span>precision :</span></dt><dd>4</dd><dt><span>long_name :</span></dt><dd>Total Scattering Coefficient of Pure Seawater</dd><dt><span>units :</span></dt><dd>m-1</dd><dt><span>ancillary_variables :</span></dt><dd>seawater_temperature,practical_salinity</dd></dl></div><div class='xr-var-data'><pre>array([0.000639, 0.000639, 0.000639, ...,      nan, 0.000638, 0.000638])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>optical_backscatter</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-3ed23a6d-2df9-46c9-ae52-a4a613a116eb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3ed23a6d-2df9-46c9-ae52-a4a613a116eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1c53e0a5-b472-407d-bd34-d9287fbf60d4' class='xr-var-data-in' type='checkbox'><label for='data-1c53e0a5-b472-407d-bd34-d9287fbf60d4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>comment :</span></dt><dd>Optical Backscatter (Red Wavelengths) is a measure of the amount of red light (630-740 nm wavelengths) scattered in the backward direction due to suspended matter within seawater, providing a proxy for turbidity and suspended solids.</dd><dt><span>long_name :</span></dt><dd>Optical Backscatter</dd><dt><span>precision :</span></dt><dd>4</dd><dt><span>data_product_identifier :</span></dt><dd>FLUBSCT_L2</dd><dt><span>units :</span></dt><dd>m-1</dd><dt><span>ancillary_variables :</span></dt><dd>total_volume_scattering_coefficient,seawater_temperature,practical_salinity</dd></dl></div><div class='xr-var-data'><pre>array([0.000701, 0.000674, 0.00069 , ...,      nan, 0.000698, 0.000722])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>int_ctd_pressure</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ce013cfe-9333-4cea-88cb-8c1872e6e30c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ce013cfe-9333-4cea-88cb-8c1872e6e30c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ff20976e-b6d9-481c-995c-8241ca8277a2' class='xr-var-data-in' type='checkbox'><label for='data-ff20976e-b6d9-481c-995c-8241ca8277a2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>comment :</span></dt><dd>Seawater Pressure refers to the pressure exerted on a sensor in situ by the weight of the column of seawater above it. It is calculated by subtracting one standard atmosphere from the absolute pressure at the sensor to remove the weight of the atmosphere on top of the water column. The pressure at a sensor in situ provides a metric of the depth of that sensor.</dd><dt><span>data_product_identifier :</span></dt><dd>PRESWAT_L1</dd><dt><span>precision :</span></dt><dd>3</dd><dt><span>long_name :</span></dt><dd>Seawater Pressure</dd><dt><span>standard_name :</span></dt><dd>sea_water_pressure</dd><dt><span>units :</span></dt><dd>dbar</dd><dt><span>axis :</span></dt><dd>Z</dd></dl></div><div class='xr-var-data'><pre>array([191.172521, 191.17917 , 191.192529, ...,        nan, 194.525926,
       194.540393])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fe5c8c94-38a4-4ae6-bbdd-94e215a99f31' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fe5c8c94-38a4-4ae6-bbdd-94e215a99f31' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>node :</span></dt><dd>SF01A</dd><dt><span>id :</span></dt><dd>RS01SBPS-SF01A-3A-FLORTD101-streamed-flort_d_data_record</dd><dt><span>geospatial_lat_min :</span></dt><dd>44.52897</dd><dt><span>geospatial_lon_min :</span></dt><dd>-125.38966</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fluor_chlor_lower_bound</span> <span class="o">=</span> <span class="o">-</span><span class="mf">.05</span>
<span class="n">fluor_chlor_upper_bound</span> <span class="o">=</span> <span class="mf">1.4</span>
<span class="n">fluor_cdom_lower_bound</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">fluor_cdom_upper_bound</span> <span class="o">=</span> <span class="mf">3.5</span>
<span class="n">fluor_vscat_lower_bound</span> <span class="o">=</span> <span class="mf">0.00005</span>
<span class="n">fluor_vscat_upper_bound</span> <span class="o">=</span> <span class="mf">0.0006</span>

<span class="n">ds_Fluorometer_time_slice</span> <span class="o">=</span> <span class="n">ds_Fluorometer</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">time0</span><span class="p">,</span> <span class="n">time1</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ds_Fluorometer_time_slice</span><span class="o">.</span><span class="n">fluorometric_chlorophyll_a</span><span class="p">,</span> \
            <span class="n">ds_Fluorometer_time_slice</span><span class="o">.</span><span class="n">int_ctd_pressure</span><span class="p">,</span> \
            <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ds_Fluorometer_time_slice</span><span class="o">.</span><span class="n">fluorometric_cdom</span><span class="p">,</span> \
            <span class="n">ds_Fluorometer_time_slice</span><span class="o">.</span><span class="n">int_ctd_pressure</span><span class="p">,</span> \
            <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ds_Fluorometer_time_slice</span><span class="o">.</span><span class="n">total_volume_scattering_coefficient</span><span class="p">,</span> \
            <span class="n">ds_Fluorometer_time_slice</span><span class="o">.</span><span class="n">int_ctd_pressure</span><span class="p">,</span> \
            <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">fluor_chlor_lower_bound</span><span class="p">,</span> <span class="n">fluor_chlor_upper_bound</span><span class="p">),</span> \
           <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">200.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;multiple profiles: fluorometer chlorophyll&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">fluor_cdom_lower_bound</span><span class="p">,</span> <span class="n">fluor_cdom_upper_bound</span><span class="p">),</span> \
        <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">200.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;multiple profiles: fluorometer CDOM&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">fluor_vscat_lower_bound</span><span class="p">,</span> <span class="n">fluor_vscat_upper_bound</span><span class="p">),</span> \
        <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">200.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;multiple profiles: fluorometer volume scattering&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>...
</pre></div>
</div>
<img alt="../_images/Ocean 01 A Photic Zone CTD_18_1.png" src="../_images/Ocean 01 A Photic Zone CTD_18_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fails</span>
<span class="c1"># run this to get a check of the units for chlorophyll </span>
<span class="c1"># ds_flort.fluorometric_chlorophyll_a.units</span>
<span class="c1"># p = rca_ds_chlor.fluorometric_chlorophyll_a.plot() is an option as well</span>
<span class="c1"># by assigning the plot to p we have future ornamentation options</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="spectral-irradiance">
<h2>Spectral Irradiance<a class="headerlink" href="#spectral-irradiance" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>The data variable is <code class="docutils literal notranslate"><span class="pre">spkir_downwelling_vector</span></code> x 7 wavelengths per below</p></li>
<li><p>9 months continuous operation at about 4 samples per second gives 91 million samples</p></li>
<li><p>DataSet includes <code class="docutils literal notranslate"><span class="pre">int_ctd_pressure</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code> Coordinates; Dimensions are <code class="docutils literal notranslate"><span class="pre">spectra</span></code> (0–6) and <code class="docutils literal notranslate"><span class="pre">time</span></code></p></li>
<li><p>Oregon Slope Base <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">:</span> <span class="pre">SF01A</span></code>, <code class="docutils literal notranslate"><span class="pre">id</span> <span class="pre">:</span> <span class="pre">RS01SBPS-SF01A-3D-SPKIRA101-streamed-spkir_data_record</span></code></p></li>
<li><p>Correct would be to plot these as a sequence of rainbow plots with depth, etc</p></li>
</ul>
<p>See <a class="reference external" href="https://interactiveoceans.washington.edu/instruments/spectral-irradiance-sensor/">Interactive Oceans</a>:</p>
<blockquote>
<div><p>The Spectral Irradiance sensor (Satlantic OCR-507 multispectral radiometer) measures the amount of
downwelling radiation (light energy) per unit area that reaches a surface. Radiation is measured
and reported separately for a series of seven wavelength bands (412, 443, 490, 510, 555, 620,
and 683 nm), each between 10-20 nm wide. These measurements depend on the natural illumination
conditions of sunlight and measure apparent optical properties. These measurements also are used
as proxy measurements of important biogeochemical variables in the ocean.</p>
<p>Spectral Irradiance sensors are installed on the Science Pods on the Shallow Profiler Moorings
at Axial Base (SF01A), Slope Base (SF01A), and at the Endurance Array Offshore (SF01B) sites.
Instruments on the Cabled Array are provided by Satlantic – OCR-507.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectral_irradiance_source</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;rca/irradiance&#39;</span>
<span class="n">ds_irradiance</span> <span class="o">=</span> <span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">spectral_irradiance_source</span> <span class="o">/</span> <span class="p">(</span><span class="s1">&#39;osb_sp_irr_spec&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.nc&#39;</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Early attempt at using log crashed the kernel</span>

<span class="n">spectral_irradiance_upper_bound</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">spectral_irradiance_lower_bound</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">ds_irr_time_slice</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds_irradiance</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">time0</span><span class="p">,</span> <span class="n">time1</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">colorwheel</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds_irr_time_slice</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spkir_downwelling_vector</span><span class="p">,</span> \
                <span class="n">ds_irr_time_slice</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">int_ctd_pressure</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mf">4.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colorwheel</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">spectral_irradiance_lower_bound</span><span class="p">,</span> <span class="n">spectral_irradiance_upper_bound</span><span class="p">),</span> \
        <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">60.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;multiple profiles: spectral irradiance&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>...
</pre></div>
</div>
<img alt="../_images/Ocean 01 A Photic Zone CTD_22_1.png" src="../_images/Ocean 01 A Photic Zone CTD_22_1.png" />
</div>
</div>
</div>
<div class="section" id="photosynthetically-available-radiation">
<h2>Photosynthetically Available Radiation<a class="headerlink" href="#photosynthetically-available-radiation" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Abbreviated PAR</p></li>
<li><p>instrument string is <em>parad</em></p></li>
<li><p>Dubious claim: Can use to identify profile time ranges</p>
<ul>
<li><p>Approximately from the PAR data and can be done very precisely using depth data</p></li>
<li><p>This suggests a derived dataset of profile start / peak / end times</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">par_source</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;rca/par&#39;</span>
<span class="n">par_data</span> <span class="o">=</span> <span class="s1">&#39;osb_sp_par_jan2019.nc&#39;</span>
<span class="n">ds_PAR</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">par_source</span> <span class="o">/</span> <span class="n">par_data</span><span class="p">)</span>
<span class="n">ds_PAR</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:            (time: 44640)
Coordinates:
  * time               (time) datetime64[ns] 2019-01-01 ... 2019-01-31T23:59:00
Data variables:
    par_counts_output  (time) float64 0.3578 0.3536 0.3587 ... 0.3482 0.3491
    int_ctd_pressure   (time) float64 191.2 191.2 191.2 ... 194.5 194.5 194.5
Attributes:
    node:                SF01A
    id:                  RS01SBPS-SF01A-3C-PARADA101-streamed-parad_sa_sample
    geospatial_lat_min:  44.52897
    geospatial_lon_min:  -125.38966</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-6dcdfbc6-12bb-4bec-87d0-10ba4c466e5c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6dcdfbc6-12bb-4bec-87d0-10ba4c466e5c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 44640</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-839fc5f9-4ee1-4da6-b7a9-958842966076' class='xr-section-summary-in' type='checkbox'  checked><label for='section-839fc5f9-4ee1-4da6-b7a9-958842966076' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2019-01-01 ... 2019-01-31T23:59:00</div><input id='attrs-9cf64dff-1aeb-40d9-88bb-77b5ee089356' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9cf64dff-1aeb-40d9-88bb-77b5ee089356' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f79eec97-cf35-4c65-b73d-c3ca28ef087c' class='xr-var-data-in' type='checkbox'><label for='data-f79eec97-cf35-4c65-b73d-c3ca28ef087c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2019-01-01T00:00:00.000000000&#x27;, &#x27;2019-01-01T00:01:00.000000000&#x27;,
       &#x27;2019-01-01T00:02:00.000000000&#x27;, ..., &#x27;2019-01-31T23:57:00.000000000&#x27;,
       &#x27;2019-01-31T23:58:00.000000000&#x27;, &#x27;2019-01-31T23:59:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a513a27b-bad8-43f8-ba50-fa5770759fba' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a513a27b-bad8-43f8-ba50-fa5770759fba' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>par_counts_output</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-f68d89bd-e1c6-4b88-9861-3e70c5518756' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f68d89bd-e1c6-4b88-9861-3e70c5518756' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4ec6134a-0f6d-4516-875d-12707ff75b41' class='xr-var-data-in' type='checkbox'><label for='data-4ec6134a-0f6d-4516-875d-12707ff75b41' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>comment :</span></dt><dd>Photosynthetically Active Radiation (PAR) is the measure of the density of photons per unit area that are in the spectral range of light (400-700 nanometers) that primary producers use for photosynthesis.</dd><dt><span>long_name :</span></dt><dd>Photosynthetically Active Radiation</dd><dt><span>precision :</span></dt><dd>4</dd><dt><span>data_product_identifier :</span></dt><dd>OPTPARW_L1</dd><dt><span>standard_name :</span></dt><dd>downwelling_photosynthetic_photon_flux_in_sea_water</dd><dt><span>units :</span></dt><dd>µmol photons m-2 s-1</dd><dt><span>ancillary_variables :</span></dt><dd>par</dd></dl></div><div class='xr-var-data'><pre>array([0.357793, 0.353646, 0.3587  , ..., 0.362043, 0.348242, 0.349065])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>int_ctd_pressure</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-838acb5f-bed5-4a14-8c11-fa3d6b45e9d5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-838acb5f-bed5-4a14-8c11-fa3d6b45e9d5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6cd4c47f-f324-4c99-b299-966e4752b656' class='xr-var-data-in' type='checkbox'><label for='data-6cd4c47f-f324-4c99-b299-966e4752b656' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>comment :</span></dt><dd>Seawater Pressure refers to the pressure exerted on a sensor in situ by the weight of the column of seawater above it. It is calculated by subtracting one standard atmosphere from the absolute pressure at the sensor to remove the weight of the atmosphere on top of the water column. The pressure at a sensor in situ provides a metric of the depth of that sensor.</dd><dt><span>data_product_identifier :</span></dt><dd>PRESWAT_L1</dd><dt><span>precision :</span></dt><dd>3</dd><dt><span>long_name :</span></dt><dd>Seawater Pressure</dd><dt><span>standard_name :</span></dt><dd>sea_water_pressure</dd><dt><span>units :</span></dt><dd>dbar</dd><dt><span>axis :</span></dt><dd>Z</dd></dl></div><div class='xr-var-data'><pre>array([191.172401, 191.179244, 191.192463, ..., 194.535418, 194.527732,
       194.539976])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b1d6d7dc-e624-447e-9e2f-517bb691430d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b1d6d7dc-e624-447e-9e2f-517bb691430d' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>node :</span></dt><dd>SF01A</dd><dt><span>id :</span></dt><dd>RS01SBPS-SF01A-3C-PARADA101-streamed-parad_sa_sample</dd><dt><span>geospatial_lat_min :</span></dt><dd>44.52897</dd><dt><span>geospatial_lon_min :</span></dt><dd>-125.38966</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">par_lower_bound</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">par_upper_bound</span> <span class="o">=</span> <span class="mi">180</span>
<span class="n">ds_PAR_time_slice</span> <span class="o">=</span> <span class="n">ds_PAR</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">time0</span><span class="p">,</span> <span class="n">time1</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds_PAR_time_slice</span><span class="o">.</span><span class="n">par_counts_output</span><span class="p">,</span> <span class="n">ds_PAR_time_slice</span><span class="o">.</span><span class="n">int_ctd_pressure</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">par_lower_bound</span><span class="p">,</span> <span class="n">par_upper_bound</span><span class="p">),</span> <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">75.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;multiple profiles: PAR counts&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>...
</pre></div>
</div>
<img alt="../_images/Ocean 01 A Photic Zone CTD_25_1.png" src="../_images/Ocean 01 A Photic Zone CTD_25_1.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ocean"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">Ocean Data Science</a>
    <a class='right-next' id="next-link" href="../visualization/index.html" title="next page">Visualization</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Cabled Array Value Added Team<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>